# SeaBattle

Игра "Морской Бой" формата человек-бот

Логика бота реализована на основе нескольких жадных алгоритмов:

- Подсчет вероятности расположения каждого из имеющихся на данный момент игры у игрока кораблей
- Режим охоты на подбитый корабль, исключающий выстрелы по уже просмотренным или невыгодным клеткам

А также на основе обычных алгоритмов:

- Стрельба в виде шахматной доски
- Стрельба на основе вероятностной карты
- Случайная стрельба (не используется в данной версии проекта)


Из всего перечисленного, пожалуй, наибольший интерес вызывает подсчет вероятности, она же вероятностая карта.
Вероятностная карта - матрица такого же размера как и поле, каждая клетка которой имеет вес, просчитываемый определенным образом для каждого имеющегося у человека корабля.

Этап работы подсчета вероятности:
- Выбор корабля из списка неуничтоженных кораблей человека
- Выбор (x, y) клетки игрового поля
- Выбор ориентации корабля (горизонтальный или вертикальный), причем проверяются оба
- Проверка возможности разместить корабль с выбранной ориентацией в (x, y) клетке
- Если такая возможность есть, то каждой клетке куда можно поместить корабль добавляется вес, причем чем больше корабль - тем существенно больше вес занимаемых им клеток (weight = length * 2)
- Если возможности нет, идем дальше

В итоге у нас сформируется вероятностная карта, которая поможет боту выбрать наиболее выгодные для стрельбы клетки.

Помимо этого, если остались только корабли размером не более 2 клеток, то алгоритм перестраивает свою работу:
- Выбирается (x, y) клетка игрового поля
- Проверяется, что эта клетка не открыта
- Возле выбранной клетки (x, y) проверяются 8 других клеток
- Если полученная клетка в области поля и входит в число открытых, то
- Добавляется +1 к переменной empty_around, которая затем устанавливает клетке (x, y) вес равный empty_around * 10

Подобный алгоритм необходим для оптимизированных действий бота в период игры, когда остаются только маленькие корабли (в основном единичной длины). Его суть в том, что он устанавливает закрытой клетке вес, который зависит от числа открытых клеток вокруг этой клетки. Чем больше это число - тем больше вес, что влияет на выбор бота.

Этапы работы бота:

- Стрельба по клеткам в шахматном порядке (так больше вероятность зацепить большой корабль, который поможет закрасить после своего уничтожения клетки вокруг себя)
- В случае попадания в корабль активируется режим добивания
- После уничтожения корабля, режим добивания сменяется выстрелами по вероятностной карте
- Выстрел по вероятностной карте обновляет эту самую вероятностную карту (так как карта обновляется не после любого выстрела - в целях экономии ресурсов компьютера)
- Начинается проверка на присутствие в вероятностной карте каких-либо весов
- Если проверка проходит, осуществляется выстрел по цели, который несет в себе 4 исхода "pass" - промах, "hit" - попадание, "destroyed" - уничтожение
- Если проверка не проходит, то возвращается исход "no targets"
- Если исход "hit", то бот переходит в режим добивания
- Стоит отметить, что исходы "pass" и "destroyed" никак не влияют на режим бота

Логика переходов бота между режимами реализована через паттерн Состояние. Исходы выстрелов определенным образом меняют режим бота: сообщают классу обработчику информацию об исходе, а тот в свою очередь реагирует на это:
- Промах - режим не меняется
- Попадание в корабль - включается режим добивания
- Уничтожение корабля - режим стрельбы по вероятностной карте
- Отсутствие целей, даваемых вероятностной картой - режим шахматной доски


В ходе выполнения этого проекта, в основном, внимание было уделено реализации логики бота. Остальная логика не так сложна, потому здесь о ней не идет речи. Каждый может ознакомиться с кодом и дать свои комментарии.
